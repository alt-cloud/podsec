define hostgroup {
    hostgroup_name  podsec-nodes
    alias           Podsec nodes
}

define servicegroup{
    servicegroup_name	nagwad-podsec
    alias		Podsec events monitored with Nagwad
    members		nagwad-podsec-containers,nagwad-podsec-images,nagwad-podsec-policy,nagwad-podsec-kubeapi,nagwad-podsec-vuln
}

define service {
	name			nagwad-podsec-containers
	hostgroup_name		nagwad-nodes
	servicegroups           nagwad-podsec
	use			generic-service
	service_description	Rootless container changed
	check_command		check_nrpe!nagwad_podsec_containers
}

define service {
	name			nagwad-podsec-images
	hostgroup_name		nagwad-nodes
	servicegroups           nagwad-podsec
	use			generic-service
	service_description	Container image violates policy
	check_command		check_nrpe!nagwad_podsec_images
}

define service {
	name			nagwad-podsec-policy
	hostgroup_name		nagwad-nodes
	servicegroups           nagwad-podsec
	use			generic-service
	service_description	Container policy errors
	check_command		check_nrpe!nagwad_podsec_policy
}

define service {
	name			nagwad-podsec-kubeapi
	hostgroup_name		nagwad-nodes
	servicegroups           nagwad-podsec
	use			generic-service
	service_description	Kubernetes audit event
	check_command		check_nrpe!nagwad_podsec_kubeapi
}

define service {
	name			nagwad-podsec-vuln
	hostgroup_name		nagwad-nodes
	servicegroups           nagwad-podsec
	use			generic-service
	service_description	Vulnerable container image
	check_command		check_nrpe!nagwad_podsec_vuln
}
